## 1.1 **Wireshark**

#### 1.1.1.1 工具的介绍

Wireshark（前称Ethereal）是一个网络封包分析软件。网络封包分析软件的功能是撷取网络封包，并尽可能显示出最为详细的网络封包资料。Wireshark使用WinPCAP作为接口，直接与网卡进行数据报文交换。

当发生网络问题，无法从日志层面定位问题，需要抓取网络包并采用Wireshark网络报文分析工具分析报文的情况，比如在确认一切正常的情况下，设备无法注册到平台，此时需要从设备端进行注册报文抓包，以确认问题。（很难用到，简单熟悉即可。）

 

#### 1.1.1.2 工具的使用

***\*使用举例：\****

比如当前设备配网后，从设备端可以查看配置的注册地址，发现没有配置错误，网络一切正常，但是设备就是没有到平台注册，此时需要确认设备到底有没有发出注册请求，发出的请求地址是什么。

***\*a)\*******\*、抓包命令\****

假设设备IP为10.35.191.116，平台地址为10.35.82.74，在设备端执行以下命令，监听一段时间后按ctrl+c终止，会在/home/ymsk/目录下生成login.pcap文件

sudo tcpdump -i any -s 0 -v -w /home/ymsk/robot.pcap src host 10.35.191.116 and dst host 10.35.82.74

***\*b)\*******\*、\*******\*将login.pcap文件拷贝到本地\****

***\*c)\*******\*、\*******\*打开Wireshark软件\****

![img](D:\VScode\gitcode\JieIYu_Markdown_1\问题记录\软件使用\Wireshark.assets\wps1.jpg) 

***\*d)\*******\*、\*******\*选择文件打开拷贝的login.pcap文件\****

![img](D:\VScode\gitcode\JieIYu_Markdown_1\问题记录\软件使用\Wireshark.assets\wps2.jpg) 

***\*e)\*******\*、\*******\*基于该报文进行问题确认\****